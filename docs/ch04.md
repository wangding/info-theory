# 第 4 章 信道

一、信道的数学模型及分类
	1. 信道的定义
	2. 分类
	3. 数学模型
二、单符号离散信道的信道容量
	0. 平均互信息量的上凸性
	1. 信道容量的定义
	2. 几种特殊离散信道的信道容量
		ⅰ 无干扰信道
			1) 无损确定信道（无噪无损信道）
			2) 无损信道（有噪无损信道）
			3) 确定信道（无噪有损信道）

好，咱们开始吧。诸位同学，大家上午好！今天咱们开始学习第4章离散信道及其容量，今天讨论两个问题，信道的数学模型和分类、单符号离散信道及其容量。在开始新的内容之前，咱们先把以前的内容稍微总结一下。从第一章我们就提到香农狭义信息论讨论了三个大问题，大家还记得吗？哪三个？一个是信息的度量，另一个是信道容量的计算，最后是失真的问题。通过第二章和第三章的学习我们已经将信息度量的问题解决了。我们知道信息的度量是利用概率统计的方法进行间接度量的。接下来的问题就是信道容量的计算了，如果我们能够计算出某种信道的容量，这样我们就有衡量不同信道的标准了。这样我们也有能力去改善信道，或者从不同的信道中做出选择。我们将要学习的第四章就是对香农狭义信息论中的第二个大问题的讨论。其实香农狭义信息论的后两个问题都是以第一个问题的解决为基础的，这一点我们在后面会进行详细的说明。
我们在第一章概述中已经介绍过通信系统模型，大家还记得通信系统模型是由哪几部分组成的吗？信源、信道和信宿。信道的定义是什么呢？信道是信息传输的通道，或者信息传输的媒介。我们在生活中有很多这样的体验，信道可能是一条电缆（比如电话线）、一条光缆甚至可以是空气（我们的声音可以在空气中传播）。我们研究信道的目的就是研究信道中能够传送或存储的最大信息量，即信道容量。信道容量是衡量信道优劣的重要指标，通过信道容量的研究我们会选择信道容量大的信道用于传输信号。
大家还记得我们讨论信源信息量的思路吗？我们在第二章讨论的自信息、熵、互信息还有平均互信息都是针对最简单的信源模型（单符号离散信源）讨论的，然后再把这个定义和概念推广到复杂的信源，这就是第三章的内容。类似于研究信源问题的这个思路，我们先把信道分一分类，从中找出一种最简单的信道，在这种最简单的信道上来研究信道容量的定义或计算，然后再把这个定义推广到更复杂的信道。这是符合我们认识事物的一般规律的——从易到难，从简到繁，从特殊到一般。从信息论的角度出发，信道一般有这样几种分类方式。
一、按照用户的多少，可以分为：
(1) 单用户信道。只有一个输入端和一个输出端的单向通信信道。我们到目前为止所讨论的通信系统模型都是单用户信道，你可以把现实生活中两个人的交谈看作是单用户信道的例子。
(2) 多用户信道。输入端或输出端，至少有一端有两个以上的用户，并且可以是双向通信的信道。多用户信道有两个特例。一个是多址接入信道（Multiple Access Channel, MAC），它有多个输入端，一个输出端，你们有没有见过这种信道？在现实生活中我们看到的法院开庭就是一个多址接入信道的例子。开庭时原告和被告都向法官陈述案件相关的事实和证据，两个输入端，一个输出端。在你们书上75页，有一幅图，图4.2卫星通信的上行线，也是一个多址接入信道的例子。大家注意一下，书上的名字叫多元接入信道，就是多址接入信道，与多址接入信道是一回事啊。另一个特例是广播信道（Broadcast Channel, BC），它有一个输入端，多个输出端，你们有没有见过这种信道？就在眼前嘛，我们在教室上课就是一个广播信道，老师是唯一的一个输入端，在座的几十位学生都是输出端。书上给的例子是卫星通信的下行线，有图，大家都能看明白。多用户信道我们在后边第10章会介绍。
二、按照输入端和输出端的关联关系，可以分为：
(1) 无反馈信道。信道输出端无信号反馈到输入端，即输出端信号对输入端信号无影响、无作用。
(2) 反馈信道。信道输出端的信号反馈到输入端，对输入端的信号起作用，影响输入端信号发生变化。你们见过吗？（收听广播）
三、按照信道的参数和时间的关系，可以分为：
(1) 固定参数信道（也叫恒参信道）。信道的参数(统计特性)不随时间变化而改变。
(2) 时变参数信道。信道的参数(统计特性)随时间变化而变化。
四、按照输入和输出信号的特点，可以分成：
(1) 离散信道。它是指输入和输出的随机序列的取值都是离散的信道。
(2) 连续信道。它是指输入和输出的随机序列的取值都是连续的信道。
(3) 半离散或半连续信道。输入序列是离散型的但相应的输出序列是连续的信道，或者相反。
(4) 波形信道。信道的输入和输出都是一些时间上连续的随机信号和。即信道输入和输出的随机变量的取值是连续的，并且还随时间连续变化。—般，可用随机过程来描述其输入和输出。
连续信道和波形信道的内容我们会在后面的第八章讨论。在这里面我们首先圈出无反馈的参数固定的单用户离散信道，这种最简单的信道作为我们的研究对象。看看这种信道的容量如何计算，然后再考虑复杂信道的情况。下面我们看看信道的数学模型。
信源输出的是携带信息的消息，而消息必须首先转换成能在信道中传输或存储的信号，而后通过信道送到收信者。并且认为噪声和干扰主要从信道引入，它使信号通过信道后产生错误和失真。因此信道的输入和输出之间一般不是确定的函数关系，而是统计依赖关系。只要知道信道的输入信号、输出信号以及它们的统计依赖关系，那么信道的全部特征就确定了。
讨论信道的数学模型就是把信道的特征或信道的参数用数学语言描述出来，这样我们才可以计算该信道的信道容量，就好像如果我们要计算一个水杯的容积，我们需要知道这个杯子的参数，把杯底圆的半径和杯子的高度用数学量描述出来。因此我们首先要搞清楚信道的参数是什么。信道的输入是随机变量，输出也是随机变量，因此，对于信源发出符号，我们不能肯定信宿一定收到符号，它们之间的关系是不确定，如果是确定的那就是函数关系。不确定的问题我们也有办法描述，那就是概率。这样，对于一个特定的信道，我们可以统计出信源发出某个符号作为条件，信宿收到某个符号的概率了。这是个条件概率，这个条件概率描述了信道的特征，我们称它为信道转移概率。信道的特征或者说信道的参数就是信道转移概率，不同的信道，它们的转移概率不同而已。
a. 离散信道的数学模型一般用下图表示，输入和输出信号是随机序列，条件概率称为信道转移概率，反映了信道输入和输出之间的统计依赖关系。其数学模型为，实际上我们会在离散信道中先讨论单符号离散信道，也就是N=1的情况。

b. 为了直观，把信道转移概率用矩阵的形式表示，称为信道转移矩阵。矩阵的行数是输入符号个数，矩阵的列数是输出符号个数。因此对于单符号离散信道，信道转移矩阵是n行m列的。

c. 还可以把信道转移概率标在带箭头的图上，称为信道转移图。下面我们举几个特殊信道的例子，通过这些例子我们熟悉一下信道转移图和信道转移矩阵两种表达方式和它们之间的关系。
二元对称信道（Binary Symmetric Channel, BSC），这是一种最常见的、应用最广泛的信道，你们见过吗？无处不在，你们上网接触的互联网Internet、打电话用的手机无线通信、甚至收看的电视节目，都称为数字通信，就是用的BSC。输入两个符号，输出两个符号，之所以称为对称，因为0和1的正确转移概率相等，都是；错误转移概率也相等，都是。它的信道转移图和信道转移矩阵如下：

二元删除信道（Binary Erasure Channel, BEC）。输入两个符号，输出三个符号（为什么叫删除？），0和1的正确转移概率分别是和；错误转移概率分别是和。它的信道转移图和信道转移矩阵如下：

二元对称消失信道。输入两个符号，输出三个符号（为什么叫消失？），因为0和1的正确转移概率相等，都是，错误转移概率也相等，都是和。它的信道转移图和信道转移矩阵如下：

这三种信道之间是可以相互转化，你们看出来了吗？…。
这些表达方式大家见过吗？在第二章学习互信息量、平均户信息量的时候大家见过。只不过我们没有进行特别的说明罢了。
在以上介绍的信道模型和分类的基础上，我们先考察一下单符号离散信道的信道容量，这种信道的输入和输出都是单符号离散信号，是信道模型中最简单的一类。
我们首先需要认识一下求解信道容量是一个什么数学问题。求解信道容量，必然是先给定一个信道模型，也就是这个信道的统计特征是给定的。信道的统计特征是什么？是信道转移概率，用信道转移概率矩阵或信道转移图描述的。所要计算的信道容量，就是这种信道能够流经的最大信息量，因此，本质上还是一个计算信息量大小的问题，而且计算的是流经信道的信息量大小。我们马上就可以想到一定和平均互信息量有关。确实如此，实际上求信道容量就是在给定信道转移概率的情况下，计算最大的平均互信息量。这样我们给出了信道容量的定义：

公式的大写字母C，代表信道容量，它是英文单词Capacity-容量的第一个字母。信道容量的单位就是信息量的单位，我们以bit为单位。
在给定信道转移概率的前提下，平均互信息量有最大值吗？我们知道平均互信息量具有上凸性，在信道转移概率给定的条件下，平均互信息量是信源概率分布的上凸函数。根据这个一点，我们知道信道容量是存在的，因为平均互信息量的最大值存在。下面我们证明一下平均互信息量的上凸性。
首先，平均互信息量的定义如下：

这样我们可以看出平均互信息量相当于信源概率分布和信道转移概率两类参数的函数。我们需要证明当信道转移概率给定时，平均互信息量是信源概率分布的上凸函数，即不等式：

成立。
证明：
令，则


其中：



所以：

这样我们利用信道容量的定义来计算单符号离散信道中几种特殊的信道容量。我们首先考察一下无干扰的单符号离散信道。无干扰的单符号离散信道又分为三种情况，分别是：无损确定信道，也称为无噪无损信道；无损信道，也称为有噪无损信道；确定信道，也称为无噪有损信道。下面我们分别计算一下这三种特殊的无干扰信道的信道容量。
(1) 无损确定信道，也称为无噪无损信道
这种信道的信道转移图和信道转移矩阵分别如下所示：

这类信道输出符号个数和输入符号个数相等，信道转移矩阵是一个方阵，而且矩阵是一个对角线全为1的单位矩阵。信道容量可以直接从公式出发去计算。

平均互信息量有三种表达形式，选择这种形式，是因为已知信道转移概率，因此噪声熵比较容易计算。噪声熵为零（如何计算，请同学自己思考），也可以验证损失熵（如何计算，请同学自己思考）也为零，因此该信道被称为无噪无损信道。平均互信息量的最大值就是Y的熵的最大值，根据最大熵定理等于，取得最大值的前提是信宿等概率分布，即（如何计算，请同学自己思考）。可以推导出信源需要等概率分布，即。计算信道容量就是找一组信源概率分布使得平均互信息量达到最大值，因此一般我们找到这个最大值后，通常要讨论一下信源的概率分布，看看这种概率分布是否存在，如果存在这个概率分布是什么。在这种信道中信源等概率分布可以使平均互信息量达到最大值。
(2) 无损信道，也称为有噪无损信道
这种信道的信道转移图和信道转移矩阵分别如下所示：
	
这类信道输出符号个数多于输入符号个数，信道转移矩阵的每一列只有一个非零元素。可以验证这种信道的反信道转移矩阵是一个只包含0和1的矩阵（如何计算，请同学自己思考。相当于确定信源，损失熵为零）。计算的反信道转移矩阵如下所示：

所以损失熵为零（如何计算，请同学自己思考），因此这种信道称为无损信道，或者是有噪无损信道（因为噪声熵不为零）。信道容量可以直接从公式出发去计算。平均互信息量有三种表达形式，选择这种形式，因为损失熵为零。平均互信息量的最大值就是X的熵的最大值，根据最大熵定理等于，取得最大值的前提是信源等概率分布，即。

(3) 确定信道，也称为无噪有损信道
这种信道的信道转移图和信道转移矩阵分别如下所示：

这类信道输出符号个数少于输入符号个数，信道转移矩阵是一个只包含0和1的矩阵（相当于确定信源，噪声熵为零）。信道容量可以直接从公式出发去计算，平均互信息量有三种表达形式，选择这种形式，因为噪声熵为零（如何计算，请同学自己思考）。该信道也被称为无噪有损信道。平均互信息量的最大值就是Y的熵的最大值，根据最大熵定理等于，取得最大值的前提是信宿等概率分布，即。可以推导出信源需要等概率分布，即（如何计算，请同学自己思考）。

我们对这三种无干扰信道做个总结。正如我们在第二章讨论平均互信息量的性质时所说的，平均互信息量有最大值，也就是流经信道的信息量有最大值，最大值就是信源熵或者信宿熵，前提是信道上没有干扰。与这里讨论的结论是一致的。
对于这三种情况我们可以用图形的方式进行解释。

有噪无损信道，输入符号少于输出符号，因此。信道容量等于较小的熵的最大值。
无噪有损信道，输入符号多于输出符号，因此。信道容量等于较小的熵的最大值。
无噪无损信道，输入符号等于输出符号，因此。信道容量等于这两个熵的最大值。

二、单符号离散信道的信道容量
	2. 几种特殊离散信道的信道容量
		ⅱ 有干扰信道
			1) 强对称信道
			2) 对称信道
			3) 准对称信道

好，咱们开始吧。诸位同学，大家上午好！咱们今天继续学习单符号离散信道及其容量。在开始新的内容之前，按照惯例咱们还是先把上次课的内容复习一下。上次课讲了第四章离散信道及其容量的两个问题：信道的数学模型和分类、单符号离散信道的信道容量。
大家需要掌握的问题有这样几个：
1、信道有几种分类方式，每种分类方式又分几类？不同类型的含义是什么？
2、信道的特征是什么？数学模型怎么表示？
3、BSC、BEC分别是什么？信道转移图和转移矩阵如何？
4、信道容量的定义是什么？信道容量求解的本质是什么？平均互信息量关于信源概率分布和信道转移概率这两个参数的函数表达式是什么？
5、无噪无损信道的容量是多少？达到信道容量时，信源概率分布满足什么条件？
好，这些问题都是上次课的重点内容，希望大家能够掌握。咱们开始今天的内容。
我们已经对无干扰信道这些特殊情况讨论过了。现在再来考察一下有干扰的单符号离散信道，虽然信道中有干扰，但是这些干扰的作用比较特殊，我们可以从信道转移矩阵看出这种特殊性。特殊的有干扰单符号离散信道，分三种情况，分别是：强对称信道，也称为均匀信道、对称信道以及准对称信道。下面我们分别讨论这三种特殊信道的信道容量。
(1) 强对称信道，也称为均匀信道
该信道的转移矩阵具有如下形式：

这类信道输出符号个数和输入符号个数相等，因此信道转移矩阵是一个方阵。在这种信道中正确转移概率是，错误转移概率是的均匀划分，即。这种信道的干扰规律性很强，矩阵的每一行都由相同的元素组成，而且组成行的元素与组成列的元素完全相同。
下面我们考察一下这种特殊信道的容量。从信道容量的定义公式出发。

对上面求解过程的说明如下：
平均互信息量有三种表达形式，选择这种形式，是因为已知信道转移概率，而且信道转移概率具有特殊性，因此噪声熵比较容易计算，噪声熵计算的结果等于常数，因此只需要计算。根据最大熵定理，取得最大值的前提是等概率分布，即。那么信源的概率分布如何呢？大家动手推导一下。结果推导出也是等概率分布，即。下面我们给出这个概率分布的推导过程：

二元对称信道(BSC)可以看成是强对称信道的特例。作为例题请大家计算一下BSC信道的容量。（同学们课上练习）
解：
直接利用强对称信道的结论，

对于BSC信道，信道容量是错误转移概率的一元函数，信道容量和的关系图如下所示。
我们从这个BSC信道容量的函数图可以发现一些规律，当错误转移概率时，信道容量达到最大，是1比特，这对应着无干扰的情况，这一点符合我们的经验——无干扰的信道容量最大。随着的增加，信道容量逐渐减小，也就是说干扰增大了，信道容量就会减小，当时，这个时候干扰最大，信道容量为0。这个情况在实际工程中需要避免，因为这样的信道是不可用的。但是在这里有进一步讨论的意义，我们可以看到当时，，达到信道容量的信源概率分布可以取任何值（请同学下面去验证）。从这个特例，我们发现达到信道容量的信源概率分布可能不唯一。这个问题我们在后面还会进一步说明。这里还有一个问题，当时，为什么越大信道容量越大呢，越大可是代表着干扰越大呀！道理何在？（可以在译码时进行选择）

好下面我们看第二种特殊的干扰信道，对称信道。
(2) 对称信道
如果信道转移矩阵的每一行都是同一集合中诸元素的不同排列，我们称矩阵行可排列。如果一个矩阵的每一列都是同一集合中诸元素的不同排列，我们称矩阵列可排列。如果一个矩阵的行和列都可排列，我们称矩阵为可排列矩阵，对应的信道称为对称信道。也就是说，对称信道的信道转移矩阵是一个行列都可排列的矩阵。
矩阵的行数和列数的关系不同，列集合和行集合的关系分别如下：
当时，
当时，
当时，
下面给出四个信道转移矩阵，我们判断一下这些信道是否是对称信道。如果是对称信道，我们进一步观察一下列集合和行集合之间的关系。
	
	
判断如下：
和的行/列都可排列，是对称信道。和的行可排列，但列不可排列，不是对称信道。其中：
：，，，
：，，，
那么有一个问题，刚才讲的强对称信道是对称信道吗？是，强对称信道的行/列都可排列，强对称信道不但是对称信道，而且各特别之处在于强对称信道的干扰也就是错误转移概率是相等的，或者说是均匀的。这一点对称信道没有这个要求。下面以为例来说明这一点。
　　　
是对称信道，正确转移概率是，错误转移概率是和，错误转移概率不相等。因此不是强对称信道，怎样就成为强对称信道了呢？像这样错误转移概率都相等，才行。那好，大家思考一下需要怎样调整一下，才能变成强对称信道？
　　　
好，我们接着来看对称信道的容量如何计算。

根据最大熵定理，熵取得最大值的前提是等概率分布，即。那么信源的概率分布如何呢？也是等概率的。下面咱们通过例题来验证一下。
例1：对称信道的转移矩阵如下，求其信道容量。（同学们课上练习）

解：

可以验证当信源等概率分布时，信宿也等概率分布，正好达到信道容量。
下面我们来看准对称信道。
(3) 准对称信道
准对称信道的转移矩阵，行可以排列，但是列不可以排列，把矩阵按列的方向分割成s个不相交的子集，每个子矩阵是行列可排列的。分割后的子矩阵最少可以包含一列。信道容量的计算，与前面两种对称信道的类似。

但是不能达到最大值。但是我们可以证明当信源等概率分布时得到的信宿概率分布可以使达到最大值，当然这个最大值比小，但是是不可能达到的，也就是说准对称信道，不会出现的情况。
证明
（有待完善）118页例题4.5.3
下面我们来看一个准对称信道的具体例子。
例1：准对称信道的转移矩阵如下，求其信道容量。并且验证信宿不可能等概率分布。（同学们课上练习）

解：

假设

都是相互矛盾的。因此准对称信道信宿不可能等概率分布。
例2：求二元对称消失信道的信道容量。（同学们课上练习）

解：
（有待完善）
现在我们对这三种信道总结一下，这三种信道的名称很特别，大家看到了吗？都有“对称”两个字，那么什么是对称呢？大家把书翻到107页倒数第二行，咱们一起看一下定义4.5.2。
定义4.5.2 若一个离散无记忆信道的信道矩阵中，每一行都是其他行的同一元素的不同排列，则此类信道为离散输入对称信道。
翻过来108页，书上给了一个例子。
例如：信道矩阵为

咱们再接着看定义4.5.3。
定义4.5.3 若一个离散无记忆信道的信道矩阵中，每一列都是其他列的同一组元素的不同排列，则称该类信道为离散输出对称信道。
下面也给了一个例子。
例如：

咱们再接着看定义4.5.4。
定义4.5.4 若一个离散无记忆信道的信道矩阵中，按照信道的输出集Y（即信道矩阵的行）可以将信道矩阵划分成n个子集（子矩阵），每个子矩阵中的每一行（列）都是其他行（列）的同一组元素的不同排列，则称这类信道为离散准对称信道。当划分的子集只有一个时，信道是关于输入输出对称的，这类信道称为对称信道。
下面也有信道矩阵的举例，大家自己看一下。其实，书上的定义和我上课讲意思一样吧，它这里所说的输入对称就是我讲的行可排列，输出对称就是列可排列。你们仔细体会一下。
这三种信道强对称、对称、准对称信道都是对称信道，只是程度有差别，强对称的条件最苛刻，依次递减，准对称的条件最宽松。但是它们都满足一个底线，就是行可排列，正是因为这个特点噪声熵H(Y/X)的计算就有容易多了，它和信源概率分布无关了，也就是说不管信源概率如何分布噪声熵是一个常量。

因此信道容道的计算都是：

这三种信道都具有这个特点，唯一需要注意的是准对称信道，信宿不能等概率分布，它的不能达大。

二、单符号离散信道的信道容量
	3. 一般信道容量

好，咱们开始吧。诸位同学，大家上午好！咱们今天讲一般信道的容量计算，在开始新的内容之前，按照惯例咱们先把上次课的内容复习一下。上次课的内容是有特殊的有干扰离散信道。
需要掌握的问题有这样几个：
1、特殊离散信道的分类，从大的分类（有干扰、无干扰）到小的分类（无干扰信道又分几类，有干扰的特殊信道又分几类）；
2、每种特殊信道的信道转移矩阵的特点，这样我们就可以从给定的信道转移矩阵来判断它是否是某种特殊信道了；
3、每种特殊信道的信道容量公式，一旦我们判断给定的信道是属于某种特殊信道，我们就可以直接利用特殊信道容量的结论来计算该信道的信道容量了。
因此总结出信道容量问题的解题思路是：首先根据信道转移矩阵判断给定信道是否是特殊信道，如果是特殊信道要进一步判断出是哪一种特殊信道，再利用特殊信道容量的结论直接进行计算。如果不是特殊信道，按照一般信道容量的算法来计算。如何计算一般信道的容量是本次课程的内容。我们把特殊信道的分类、信道转移矩阵的特点以及信道容量的计算公式总结如下：
分类	转移矩阵特点	信道容量
特
殊
信
道	无
干
扰	无噪无损信道	，矩阵元素除了１就是０	
		有噪无损信道	，矩阵每列只有一个非零元素	
		无噪有损信道	，矩阵元素除了１就是０	
	有
干
扰	强对称	，矩阵对角线元素是，其余元素是	
		对称	行列都可排列	
		准对称	只有行可排列	
备注：
1. 和分别代表信道转移矩阵的行数和列数；
2. 强对称信道的转移矩阵行列也都可排列；
3. 所有特殊信道达到信道容量的前提都是信源等概率分布，即；
4. 它是信道转移矩阵任意一行元素的熵值。
好，这些问题是前两次课的重点内容，希望大家能够掌握。咱们开始今天的内容。前面课程讲到了特殊的单符号离散信道的信道容量，我们的求解思路是：因为信道转移矩阵都具有特殊性，因此噪声熵就成为解决问题的突破口，对于无干扰信道，噪声熵可能为零，对于有干扰信道，噪声熵为常数（这个常数的计算公式和物理含义我们需要非常熟悉），因此在平均互信息量的三种表达形式中选择这种形式，来计算最大值作为信道容量。
但是如果信道转移矩阵没有这些特殊性，我们对于信道容量的求解就无法按照这个思路进行了。这时我们需要从数学角度重新审视信道容量求解的数学本质，在搞清楚这个数学问题后，我们可以从纯数学的角度进行求解。
平均互信息量的表达式以及信道容量的定义如下：


从这两个表达式我们可以看出在信道给定的前提下，也就是说信道转移概率已知的前提下，如果信源有个符号，则平均互信息量是信源概率分布的元函数，信道容量就是找一组概率分布，使得此元函数达到极大值，当然这里面还有一个附加条件，这元自变量求和为1，也就是概率空间是封闭的。因此求解信道容量的问题，从数学的角度来看就是求解元函数的条件极值问题。我们在高等数学中学过多元函数的条件极值的求解方法——拉格朗日乘子法。
我们先把这个数学知识简单的复习一下，然后利用这个数学工具来求解一般信道的容量问题。
拉格朗日乘子法是在原函数的基础上构造一个新函数，例如：

在新构造的函数引入了一个待定系数（称为拉格朗日乘子，引入待定系数的个数与条件的数量相等），同时也把条件引入到新构造的函数中，而新构造的函数其实与原函数是等价的。对新构造的函数在每个自变量分量上求偏导数，让偏导数为零，这样可以建立个方程，求解出每个自变量分量的值，这个值当中包含待定系数。

利用条件可以求出待定系数来，因此个自变量的值可以解出，而这个自变量的值就是使元函数达到最大值时的自变量取值，把这个自变量值代入到函数中就可以求出函数的最大值。
下面我们按照这个思路来求解平均户信息量的最大值，也就是一般信道的信道容量。


推导到这里我们还没有最后算出信道容量，以及达到信道容量的信源概率分布来。但是我们得到一种中间结论，就是下面的定理：
定理：一般离散信道的平均互信息量达到极大值（即信道容量）的充分必要条件是输入概率分布满足：

证明略。参考教材115页到118页。
这个定理知给出了最佳输入概率分布应该满足的条件，并没有给出输入概率分布的具体计算公式，也没有给出信道容量的计算公式。定理隐含的说明达到信道容量的概率分布不一定是唯一的。如果要利用这个定理来计算信道容量，我们只能去假设信源的概率分布，然后验证假设的概率分布是否满足两个条件，如果满足两个条件，则信道容量可以计算出来，否则，改变概率分布再去尝试。我们通过两个例题，来说明一下如何利用这个定理求解某些信道容量的问题。
例1：设信道如图所示。输入符号集为{0, 1, 2}，输出符号集为{0, 1}。信道转移矩阵如下

求该信道的信道容量。
解：
首先我们判断这个信道是特殊信道吗？不是。信道转移矩阵的行不可排列，列可以排列。它是一般信道。
我们观察到如果，即符号不会发出，信道变成二元无噪无损信道，二元无噪无损信道的容量是1比特，前提是信源等概率分布。
因此，我们假设信源概率分布为：，
则：


满足：

所以，信源概率分布为：，
信道容量为1比特。

例2：设离散信道如图所示。输入符号集为，输出符号集为。信道转移矩阵如下

求该信道的信道容量。
解：
首先我们判断这个信道是特殊信道吗？不是。信道转移矩阵的行不可排列，列可以排列。它是一般信道。
我们观察到如果，即符号不会发出，信道变成无噪有损信道，无噪有损信道的容量是1比特，前提是信源等概率分布。
因此，我们假设信源概率分布为：
，
则：



满足：

所以，信源概率分布为：
，
信道容量为1比特。
另外，我们也可以假设信源概率分布为：
，
信道变成二元无噪无损信道，二元无噪无损信道的容量是1比特，前提是信源等概率分布。验证后，发现这个概率分布也满足两个条件。因此，从这个例子我们可以明显地看出，达到信道容量的概率分布并不是唯一的。在这个例子中就有两种信源概率分布，都使得平均互信息量达到最大值。
从这两个例题可以看到，这个定理能够求解的信道也是比较特殊的信道，这种信道的概率分布比较好猜，更为一般的信道容量的计算，我们需要进一步完成刚才的多元函数求条件极值的过程，可以利用方程组的办法解出信道容量和输入概率分布来。
继续刚才的推导过程，我们从得到的中间结论开始。

总结出一般信道容量的计算步骤如下：
(1) 利用方程组（个方程个未知数），求出个；
(2) 利用公式，求出信道容量；
(3) 利用公式，求出信宿概率分布；
(4) 利用公式，求出信宿概率分布，验证。
下面通过一个例题来练习一下一般信道容量求解的过程。
例3：离散信道转移矩阵如下所示：

求该信道的信道容量。
解：
(1) 利用方程组，求

解得：

(2) 利用公式，求出信道容量

(3) 利用公式，求出信宿概率分布

(4) 利用公式，求出信宿概率分布，验证。

信源概率分布合理，信道容量存在。

利用方程组求解一般信道容量时需要在最后验证信源概率分布的合理性，因为概率的取值范围，这个条件在构造拉格朗日乘子函数时没有考虑进去，因此可能算出信源概率分布不在合理取值区间内的情况。另外，如果信道转移矩阵的行数小于列数，就会出现方程组中方程的个数少于未知数的个数，这样无法解出信道容量。因此一般信道容量算法适合于输入符号个数大于等于输出符号个数的情况。

三、多符号离散信道
	1、数学模型
	2、信道容量的定义
	3、与之间的关系
		a、信源无记忆
		b、信道无记忆
		c、信源和信道都无记忆
	4、离散无记忆扩展信道的容量
四、独立并联信道
	1、数学模型
	2、信道容量

好，咱们开始吧。诸位同学，大家上午好！咱们今天学习多符号离散信道以及并联信道的容量，在开始新的内容之前，按照惯例咱们先把上次课的内容复习一下。上次课的内容是一般单符号离散信道的信道容量。
大家需要掌握的问题有这样几个。
1、一般单符号离散信道容量求解的数学本质是什么？
2、平均互信息函数达到极大值时，信源概率分布应该满足的条件是什么？
3、一般单符号离散信道容量求解的步骤是什么？
4、一般单符号离散信道容量求解方法的限制是什么？
好，这些问题都是上次课的重点内容，希望大家能够掌握。咱们开始今天的内容。前面课程讲到了单符号离散信道的信道容量计算的问题，我们首先给出了信道容量的定义，然后讨论了特殊的单符号离散信道的信道容量，其次讨论了一般的单符号离散信道的信道容量。这样我们已经基本搞清楚了如何计算单符号离散信道的容量。下面我们将以单符号离散信道的容量计算为基础，讨论几种更复杂的信道。这次课我们讨论两种信道：离散无记忆扩展信道和独立并联信道，下次课我们讨论串联信道。
我们先对多符号离散信道建立数学模型，然后在此基础上再讨论信道容量的问题。类似于单符号离散信道的数学模型，多符号离散信道的信道特征也是一个条件概率，区别在于这个条件概率是以信源发出的符号序列为条件，信宿收到符号序列的条件概率，同样这个条件概率我们也称为信道转移概率。它描述的是信源发出符号序列与信宿收到符号序列之间的不确定关系。
a. 多符号离散信道的数学模型一般用下图表示，输入和输出信号是随机序列，条件概率称为信道转移概率，反映了信道输入和输出之间的统计依赖关系。我们可以看出当输入序列和输出序列的长度为1时，多符号离散信道就是单符号离散信道，因此前面讨论的单符号离散信道可以看作是多符号离散信道的特例。

b. 为了直观，把信道转移概率用矩阵的形式表示，称为信道转移矩阵。矩阵的行数是输入符号序列的个数，矩阵的列数是输出符号序列的个数。信道转移矩阵是行列的，如果是单符号离散信道的次扩展信道，则，。

c. 也可以把信道转移概率标在带箭头的图上，称为信道转移图。以二元对称信道的二次扩展为例，说明信道转移图和信道转移矩阵两种表达方式之间的关系。
二元对称信道（Binary Symmetric Channel, BSC），是一种常见的、应用广泛的二元离散信道。它的信道转移图和信道转移矩阵如下：

它的二次扩展信道转移图和信道转移矩阵如下：

我们可以验证，信道转移矩阵的行数，信道转移矩阵的行数。
在多符号的情况下，总会涉及到符号和符号之间的关联关系，也就是记忆性。对于一个无记忆的多符号离散信道，信道转移概率满足下面的定理。
定理：信道是无记忆信道的充要条件是：

证明：
(1) 充分性（由表达式信道是无记忆的）

说明信道在时刻的输出只与的输入有关，而与以前的输入和输出都没有关系，此信道是无记忆信道。
(2) 必要性（由无记忆信道表达式）

类似于单符号离散信道的信道容量的定义，定义多符号离散信道的信道容量为：

我们知道多符号平均互信息量，有下面的表达式：

问题是多符号平均互信息量与传输单个符号的平均互信息量之间有什么联系。我们分三种情况来考察这个问题。
(1) 当信源无记忆时（信道有记忆）
证明：


(2) 当信道无记忆时（信源有记忆）
证明：

(3) 信源和信道都无记忆时 
证明：
当信源和信道都无记忆时，下列两个不等式应同时满足：

显然才能保证两个不等式都成立。
离散无记忆扩展信道相当于多符号离散信道中，信源和信道都无记忆的情况。而且由于它是单符号离散信道的扩展，因此每个平均互信息量分量都相同，即。所以该信道的信道容量为扩展前单符号离散信道的倍。

结论说明离散无记忆次扩展信道的信道容量，相当于单符号离散信道容量的倍。
我们再来考察一下独立并联信道的情况。独立并联信道的数学模型可以用下面的图示描述：

个信道并联，每个信道的输出只与本信道的输入有关，与其他信道的输入和输出无关。也就是说，下面的等式成立：

相当于信道无记忆时的情况，因此满足下面的不等式：

所以独立并联信道的容量：



五、串联信道和数据处理定理
	1、串联信道的数学模型
2、串联信道的信道容量
3、数据处理定理

好，咱们开始吧。诸位同学，大家上午好！咱们这次课讲本章最后一个问题串联信道和数据处理定理，在开始新的内容之前，按照惯例咱们先把上次课的内容复习一下。上次课的内容是第4章的两个问题，多符号离散信道和独立并联信道的容量。
大家需要掌握的问题有这样几个。
1、多符号离散信道的数学模型是什么？
2、多符号无记忆信道的信道转移概率与单符号信道转移概率的关系是什么？
3、分三种情况：信源无记忆、信道无记忆和信源/信道都无记忆，说明多符号平均互信息量与单符号平均互信息量之间的关系是什么？ 
4、离散无记忆次扩展信道的容量是多少？
5、独立并联信道的数学模型是什么？
6、独立并联信道的容量是多少？
好，这些问题都是上次课的重点内容，希望大家能够掌握。咱们开始今天的内容。上次课程我们在单符号离散信道的基础上介绍了两种更复杂的信道：多符号离散信道和独立并联信道。这次课程我们继续介绍另一种比较复杂的情况：串联信道。
上次课讲的并联信道和这次课讲的串联信道其实都属于信道组合的问题。信道组合在通信工程中有很多实际的应用价值，如果待发送的消息比较多时，可能会用到两个或多个信道并行传输，这就是并联信道。你可以把计算机的外部存储设备和计算机主板之间连接的数据线（IDE数据线）看成是若干个BSC信道的并联。有时信息在远距离通信时需要中继，这种情况可以看成是信道串联。比如，传播电视信号的电视塔或者卫星和地面站形成的覆盖全球的通信网络。我们已经讨论了独立并联信道的情况。这次课我们讨论第二种信道组合——串联信道。
我们首先考察一下串联信道的数学模型。串联信道的数学模型可以用下面的图示描述，整个信道是由第Ⅰ级信道和第Ⅱ级信道串联起来的。信道Ⅰ的特征是条件概率，信道Ⅱ的特征是条件概率。

串联后总的信道特征仍然是一个条件概率，这个条件概率是、还是？应该是条件概率。当然条件概率称为串联信的信道转移概率。问题是串联后总的条件概率与串联的两级信道的转移概率之间有什么关系？

可以看出串联后信道的转移矩阵是被串联的两级信道转移矩阵的乘积。问题是通常我们只知道第二级信道的转移概率，如果，那么我们讨论的问题就得到简化了。我们要讨论的串联信道正是这类特殊的串联信道，X、Y、Z构成马氏链。也就是信道Ⅱ的转移概率满足条件：，它的含义是信道Ⅱ的输出Z只与它的当前输入Y有关，与更以前的输入X没有关系，就是马尔可夫过程的后无效性。我们通常把时间离散的马尔可夫过程称为马尔可夫链或马氏链。这样串联信道的转移矩阵就是两个独立信道的转移矩阵的乘积：。
下面我们先研究一下串联信道中平均互信息量的一些定理，以这个为基础再来讨论串联信道的容量问题。
定理1：当且仅当时等号成立。
含义：一般情况下X、Y联合关于Z的信息量大于等于Y关于Z信息量，只有在X、Y、Z构成马氏链时，X、Y联合关于Z的信息量等于Y关于Z信息量，这正反映了后无效性的特点。
证明：

定理说明，当X、Y、Z构成马氏链时，X、Y联合关于Z的信息量等于Y关于Z信息量，这正反映了马氏链的后无效性的特点。
对于串联信道三个平均互信息量、、之间又有什么关系呢？
定理2：如果X、Y、Z构成马氏链，则有

含义：当X、Y、Z构成马氏链时，经过第Ⅰ级信道的信息量和经过第Ⅱ级信道的信息量要大于等于经过串联后整体的信息量。通过整个串联信道的信息量一般要比经过每一级信道的信息量要小，最多保持相等。
证明：

同理可得：
（请学生给出证明过程）
证明：

如果把定理2推广到个信道串联的情况，则有下面的结论。
推论：个信道串联构成马氏链，则有：


含义：个信道串联构成马氏链时，串联的信道越多经过整个信道的信息量可能越小，最多只能和原来一样多。这就是信息不增原理。
证明：略。
下面我们来讨论信道容量。信道容量的定义仍然是平均互信息量的最大值。因此有：

因为：
所以：
这说明串联的信道数量越多，串联后总的信道容量可能越小。如果串联的是无干扰信道，串联后的信道容量不减小。如果串联的是有干扰信道，串联信道的数量很大时，信道容量趋于零。
例1：计算两个BSC信道串联后的信道容量。

串联	信道转移矩阵	信道容量
I		
I,II		

从上面的n级BSC信道串联的平均互信息量图可以看出，当错误概率很小时，例如，计算串联后的平均互信息量减小的非常小。所以，串联级数n足够大时，串联信道的信道容量虽然减小，但仍有一定的数量。而实际数字通信网中，BSC信道的错误概率一般在以下，所以若干次串联后信道容量的减小并不明显。但是当比较大时，例如，计算串联后的平均互信息量减小的非常明显。当串联信道的数量比较大时，信道容量就会趋于零。
例2：有两个信道的转移矩阵分别为
 和
串联信道图如右所示：
计算该串联信道的转移概率。
解：
串联后信道X、Y、Z构成马氏链。
所以

串联后的信道转移概率。因此。
定理2非常重要，它说明通过串联信道的传输只会丢失更多的信息，如果满足，即串联信道总的信道转移概率等于第Ⅰ级信道的转移概率时，通过串联信道传输后不会增加信息的损失。当然如果第Ⅱ级信道是一个无噪无损信道，这个条件显然可以满足。上面的例2也说明了这个问题。
如果第Ⅱ级信道是数据处理系统，定理2就表示通过数据处理后，一般只会增加信息的损失，最多保持原来获得的信息，不可能比原来获得的信息有所增加，也就是说，对接收的数据Y进行处理后，无论变量Z是Y的确定对应关系还是概率关系，绝不会减少关于X的不确定性。若要使数据处理后的关于X的平均互信息保持不变，必须满足。所以定理2也称为数据处理定理。